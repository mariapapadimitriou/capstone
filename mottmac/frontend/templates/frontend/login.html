<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <title>Bike Route Comparison Tool</title>
    {% load static %}

    <!--Select Pickers Bootstrap-->

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/css/bootstrap-select.min.css">
    
    <!-- Custom Nunito Fonts-->
    <link href="https://fonts.googleapis.com/css?family=Nunito:200,200i,300,300i,400,400i,600,600i,700,700i,800,800i,900,900i" rel="stylesheet">

    <!-- Template Styles-->
    <link rel="stylesheet" type="text/css" href="{% static "css/dashboard.css" %}"/>
    <link rel="stylesheet" type="text/css" href="{% static "css/site.css" %}"/>

    <!--MapBox-->
    <script src='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.js'></script>
    <link href='https://api.mapbox.com/mapbox.js/v3.3.1/mapbox.css' rel='stylesheet' />

    <script src="https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.js"></script>
    <link href="https://api.tiles.mapbox.com/mapbox-gl-js/v2.6.1/mapbox-gl.css" rel="stylesheet"/>

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-draw/v1.2.2/mapbox-gl-draw.css" type="text/css">

    <script src="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.min.js"></script>
    <link rel="stylesheet" href="https://api.mapbox.com/mapbox-gl-js/plugins/mapbox-gl-geocoder/v4.7.2/mapbox-gl-geocoder.css" type="text/css">

    <!--Turf.js-->
    <script src="https://unpkg.com/@turf/turf@6/turf.min.js"></script>

    <!--Plotly.js and other charts-->
    <script src='https://cdn.plot.ly/plotly-2.6.3.min.js'></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.9.4/Chart.min.js"></script> 
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.4.1.min.js"></script>

    <!--FontAwesome Icons-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
    <script src="https://kit.fontawesome.com/4ba8d40944.js" crossorigin="anonymous"></script>

    <!---->
    <script src="https://cdn.jsdelivr.net/npm/js-cookie@3.0.1/dist/js.cookie.min.js"></script>
    
  </head>

  <body id="page-top">

    <!-- Page Wrapper -->
    <div id="wrapper">

        <!-- Content Wrapper -->
        <div id="content-wrapper" class="d-flex flex-column">

            <!-- Main Content -->
            <div id="content">
              <div id="submitPopup" class="modal">
                <div class="modal-content">
                  <div class="contact-form">
                    <form action="/">
                      <div>
                        <h1 id = "savetype" style="color: black; font-weight: bold;"></h1>
                        <h2 id="routename"></h2>
                        <input type="text" name="name" id = "save_name"  onkeypress="validate(this)" onkeyup="validate(this)" required placeholder="Enter here (letters and numbers only, no punctuation or special characters)" title="letters and numbers only, no punctuation or special characters" autocomplete="off">
                      </div>
                      <div id="validchars" style="color: red;"></div>
                      <div id="validname" style="color: red;"></div>
                      <div style="height: 20px;"></div>
                      <div class="formactionbtns">
                      <input class = "formbtns" type="submit" id="formsubmit"></input>
                      <button class = "formbtns"  type="cancel" id="formcancel" >Cancel</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
              <div id="submitStatusPopup" class="modal">
                <div class="modal-dialog modal-md">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h3 id = "statusheader" style="color: green;">Success</h3>
                    </div>
                    <div class="modal-body">
                      <p id = "statusmessage" style="color: black; justify-content: center;"></p>
                    </div>
                  </div>
                </div>

              </div>
                <!-- Begin Page Content -->
                <div class="container-fluid" style="padding: 20px">
                    <div class="col" id="allplots">
                        <div class="row">
                            <div class="row">
                                <div class="col">
                                  <div class="card border-left-primary shadow h-100 py-2">
                                    <div class="card-body">
                                      <div class="row" style="margin-top: -15px;">
                                        <div class="col chartbox">
                                          <div class="text-s font-weight-bold text-primary text-uppercase mb-1">
                                            <div class="iconscontainer">
                                              Cost&nbsp;&nbsp;&nbsp;
                                              <div class="icon">
                                                <i class="fas fa-info-circle"></i>
                                                <span>
                                                  Cost (CAD) to construct proposed bike lane 
                                                  <br>
                                                  <code>Cost = (Unit Cost for Lane Type (CAD)) * Length of Route (km)</code>
                                                </span>
                                              </div>
                                            </div>
                                          </div>
                                          <div id="cost" style="margin: 0px; padding:0px; width: 100%; height: 100%;"></div>
                                        </div>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                        </div>
                        <div class="row">
                            Hello
                        </div>
                        <div class="row">
                            Hello
                        </div>
                        <div class="row">
                            Hello
                        </div>
                    </div>
                    <div class="col">
                        <div class="col">
                            e
                        </div>
                        <div class="col">
                            e
                        </div>
                        <div class="col">
                            e
                        </div>
                    </div>

                    <!-- Content Row -->
                    <div class="row align-items-top row-grid">
                      <div class="col-xl-3 col-md-12" id="allplots">
                        <div class="row" style="padding: 0px 0px 0px 0px;">
                          <div class="col">
                            <div class="card border-left-primary shadow h-100 py-2">
                              <div class="card-body">
                                <div class="row" style="margin-top: -15px;">
                                  <div class="col chartbox">
                                    <div class="text-s font-weight-bold text-primary text-uppercase mb-1">
                                      <div class="iconscontainer">
                                        Cost&nbsp;&nbsp;&nbsp;
                                        <div class="icon">
                                          <i class="fas fa-info-circle"></i>
                                          <span>
                                            Cost (CAD) to construct proposed bike lane 
                                            <br>
                                            <code>Cost = (Unit Cost for Lane Type (CAD)) * Length of Route (km)</code>
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                    <div id="cost" style="margin: 0px; padding:0px; width: 100%; height: 100%;"></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row" style="padding: 20px 0px 0px 0px;">
                          <div class="col">
                            <div class="card border-left-primary shadow h-100 py-2">
                              <div class="card-body">
                                <div class="row" style="margin-top: -15px;">
                                  <div class="col chartbox">
                                    <div class="text-s font-weight-bold text-primary text-uppercase mb-1">
                                      <div class="iconscontainer">
                                        Ridership&nbsp;&nbsp;&nbsp;
                                        <div class="icon">
                                          <i class="fas fa-info-circle"></i>
                                          <span>
                                            Expected Number of Bikers
                                            <br>
                                            <code>Population Within 1 km of Route * Percent Bicycle Commuters</code>
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                    <div id="ridership" style="margin: 0px; padding:0px; width: 100%; height: 100%;"></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row" style="padding: 20px 0px 0px 0px;">
                          <div class="col">
                            <div class="card border-left-primary shadow h-100 py-2">
                              <div class="card-body">
                                <div class="row" style="margin-top: -15px;">
                                  <div class="col chartbox">
                                    <div class="text-s font-weight-bold text-primary text-uppercase mb-1">
                                      <div class="iconscontainer">
                                        Saved Emissions&nbsp;&nbsp;&nbsp;
                                        <div class="icon">
                                          <i class="fas fa-info-circle"></i>
                                          <span>
                                            Saved CO<sub>2</sub>e Per Day (kg)
                                            <br>
                                            <code>(Saved CO<sub>2</sub>e) (g/km) * (Length of Route (km)) * (Expected Ridership) * (Percent New Riders)</code>
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                    <div id="emissions" style="margin: 0px; padding:0px; width: 100%; height: 100%;"></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row" style="padding: 20px 0px 0px 0px;">
                          <div class="col">
                            <div class="card border-left-primary shadow h-100 py-2">
                              <div class="card-body">
                                <div class="row" style="margin-top: -15px;">
                                  <div class="col chartbox">
                                    <div class="text-s font-weight-bold text-primary text-uppercase mb-1">
                                      <div class="iconscontainer">
                                        Safety&nbsp;&nbsp;&nbsp;
                                        <div class="icon">
                                          <i class="fas fa-info-circle"></i>
                                          <span>
                                            SAFETY
                                            <br>
                                            <code>Safety increase from no bicycle infrastructure</code>
                                          </span>
                                        </div>
                                      </div>
                                    </div>
                                    <div id="safety" style="margin: 0px; padding:0px; width: 100%; height: 100%;"></div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                      <div class="col-9">
                        <div class="row">
                          <div class="col mapdiv">
                            <div class="card shadow mb-4">
                              <!-- Card Header - Dropdown -->
                              <div
                                  class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                  <h6 class="m-0 font-weight-bold text-primary">Map</h6>
                                  <select class="selectpicker" id="routepicker" onchange="getRoutes()" data-live-search="true" title="Saved Routes" data-selected-text-format="count">
                                    {%for r in savedrouteslist %}
                                    <option>{{r}}</option>
                                    {% endfor %}
                                  </select>                                  
                              </div>
                              <!-- Card Body -->
                              <div class="row">
                                <div class="col-9">
                                  <div id="app"></div>
                                  <div class="currentroutes-box">
                                    <p style="float: right;">
                                      Existing Routes &nbsp;&nbsp;&nbsp;<img src="../../static/data/blackline.png" width="30%" height="100%">
                                    </p>
                                  </div>
                                </div>
                                <div class="col-3">
                                  <div style = "height: 20px;"></div>
                                    <div style = "justify-content: left; margin-left: -10px;">
                                      <button class="addroutebtn" id="addroutebtn">Add New Route&nbsp;&nbsp;<i class='fa fa-plus-circle'></i></button>
                                    </div>
                                    <div class="legend-box" id="legend-box">
                                      <p style="font-weight: bold; color: black;">Legend</p>
                                      <div id="legend">
                                      </div>
                                    </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                        <div class="row">
                          <div class="col">
                            <div class="row">
                              <div class="col">
                                <div class="card shadow mb-4">
                                  <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                    <h6 class="m-0 font-weight-bold text-primary">Overrides</h6>  
                                    <div style="display: flex; flex-direction: row; justify-content: flex-end; width: 100%; margin: -10px -10px -10px 10px; gap: 10px;">
                                      <button class="refresh_button" id="refresh_button">Refresh &nbsp;&nbsp;<i class="fas fa-sync-alt"></i>&nbsp;</button>
                                      <select class="selectpicker" id="overridepicker" onchange="getOverrides()" data-live-search="true" title="Saved Overrides">
                                        {%for o in savedoverrideslist %}
                                          {% if o == "Default" %}
                                            <option select>{{o}}</option>
                                          {% else %}
                                            <option>{{o}}</option>
                                          {% endif %}
                                        {% endfor%}
                                      </select>   
                                      <button class="refresh_button" id="saveoverridebtn" onclick="saveOverrides()">Save &nbsp;&nbsp;<i class='fas fa-save'></i>&nbsp;</button>
                                    </div>
                                  </div>
                                  <div class="card-body" style="font-size: 14px;">
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Unit Cost (CAD) per km">Cost - Sharrows <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="sharrows_cost_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="sharrows_cost_track" id="sharrows_cost_track"> 
                                          <input type="range" min="0" max="50000" value={{SHARROWS_UNIT_COST_MIN}} id="sharrows_cost_slider_1" oninput="sharrowsCostSlide1()">
                                          <input type="range" min="0" max="50000" value={{SHARROWS_UNIT_COST_MAX}} id="sharrows_cost_slider_2" oninput="sharrowsCostSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="sharrows_cost_range_2">100</span>
                                      </div>
                                    </div>
                                    <div class="row" style="margin-top: 42px; margin-bottom: 10px;"></div>
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Unit Cost (CAD) per km">Cost - Striped <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="striped_cost_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="striped_cost_track">
                                          <input type="range" min="0" max="75000" value={{STRIPED_UNIT_COST_MIN}} id="striped_cost_slider_1" oninput="stripedCostSlide1()">
                                          <input type="range" min="0" max="75000" value={{STRIPED_UNIT_COST_MAX}} id="striped_cost_slider_2" oninput="stripedCostSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="striped_cost_range_2">100</span>
                                      </div>
                                    </div>
                                    <div class="row" style="margin-top: 42px; margin-bottom: 10px;"></div>
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Unit Cost (CAD) per km">Cost - Protected <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="protected_cost_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="protected_cost_track">
                                          <input type="range" min="0" max="500000" value={{PROTECTED_UNIT_COST_MIN}} id="protected_cost_slider_1" oninput="protectedCostSlide1()">
                                          <input type="range" min="0" max="500000" value={{PROTECTED_UNIT_COST_MAX}} id="protected_cost_slider_2" oninput="protectedCostSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="protected_cost_range_2">100</span>
                                      </div>
                                    </div>
                                    <div class="row" style="margin-top: 42px; margin-bottom: 10px;"></div>
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Percentage of 15-55 year olds who are bicycle commuters">% Bike Commuters <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="bike_commuters_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="bike_commuters_track">
                                          <input type="range" min="0" max="20" value={{BIKE_RIDERS_MIN}} id="bike_commuters_slider_1" oninput="bikeCommutersSlide1()">
                                          <input type="range" min="0" max="20" value={{BIKE_RIDERS_MAX}} id="bike_commuters_slider_2" oninput="bikeCommutersSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="bike_commuters_range_2">100</span>
                                      </div>
                                    </div>

                                    <div class="row" style="margin-top: 42px; margin-bottom: 10px;"></div>
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Percentage of riders on path who are new cyclists">% New Riders <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="modal_shift_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="modal_shift_track">
                                          <input type="range" min="0" max="30" value={{MODAL_MIN}} id="modal_shift_slider_1" oninput="modalShiftSlide1()">
                                          <input type="range" min="0" max="30" value={{MODAL_MAX}} id="modal_shift_slider_2" oninput="modalShiftSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="modal_shift_range_2">100</span>
                                      </div>
                                    </div>

                                    <div class="row" style="margin-top: 42px; margin-bottom: 10px;"></div>
                                    <div class="row">
                                      <div class="col-4" style="color: #5a5c69; font-weight: bold;"><span data-tooltip-text="Saved CO2e emissions per km for every 1 car removed">Saved CO2e / km <i class="fas fa-info-circle"></i></span></div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="emissions_range_1">0</span>
                                      </div>
                                      <div class="col-4">
                                        <div class="emissions_track">
                                          <input type="range" min="0" max="300" value={{EMISSIONS_MIN}} id="emissions_slider_1" oninput="emissionsSlide1()">
                                          <input type="range" min="0" max="300" value={{EMISSIONS_MAX}} id="emissions_slider_2" oninput="emissionsSlide2()">
                                        </div>
                                      </div>
                                      <div class="col-2" style="text-align: center">
                                        <span id="emissions_range_2">100</span>
                                      </div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                          <div class="col">
                            <div class="card shadow mb-4">
                              <div class="card-header py-3 d-flex flex-row align-items-center justify-content-between">
                                <h6 class="m-0 font-weight-bold text-primary">Multi-Objective Comparison</h6>
                              </div>
                              <div class="card-body">
                                <div class="row">
                                  <div class="col-1" style="margin-top: -5px;">
                                    <div class="row" style="color: #858796; font-size: 12px; text-align: center; font-weight: bold; margin-left: -5px;">
                                      BEST
                                    </div>
                                    <div style="height: 6px;"></div>
                                    <div class="row" style="margin-left: 2px">
                                      <img src="../../static/data/gradient.png" width="50%" height="350px">
                                    </div>
                                    <div style="height: 6px;"></div>
                                    <div class="row" style="color: #858796; font-size: 12px; font-weight: bold; margin-left: -10px;">
                                      WORST
                                    </div>
                                  </div>
                                  <div class="col-11">
                                    <div class="chart-area" style="height: 395px;">
                                      <div><div id="myChart" style="width:100%; height: 395px;"></div></div>
                                    </div>
                                  </div>
                                </div>
                              </div>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                </div>
                <!-- /.container-fluid -->

            </div>
            <!-- End of Main Content -->

        </div>
        <!-- End of Content Wrapper -->
    </div>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap-select@1.14.0-beta2/dist/js/bootstrap-select.min.js"></script>
<script type="text/javascript" src="{% static "javascript/costGraph.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/ridershipGraph.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/emissionsGraph.js" %}"></script>
<!-- <script type="text/javascript" src="{% static "javascript/trafficGraph.js" %}"></script>  -->
<script type="text/javascript" src="{% static "javascript/safetyGraph.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/map.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/numberFormats.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/linechart.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/sliders.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/save.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/get.js" %}"></script>
<script type="text/javascript" src="{% static "javascript/functions.js" %}"></script>
<script>

  document.getElementById("refresh_button").addEventListener("click", function() {
    updateCharts()
  });

</script>

</body>

</html>